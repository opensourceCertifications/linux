<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# library

```go
import "chaos-agent/library"
```

Package library provides file corruption utilities.

Package library provides a simple "cyclic jumble" for regular files. It filters input paths to real regular files, shuffles, then cycles content. Destination files keep their original metadata \(mode, uid/gid, xattrs best\-effort, atime/mtime\).

Package library provides utility functions for file selection. It includes functionality to pick random binaries from common system directories.

## Index

- [func CorruptFile\(path string, percent int\) \(retErr error\)](<#CorruptFile>)
- [func CyclicJumble\(paths \[\]string\) error](<#CyclicJumble>)
- [func EncryptMessage\(message string, encryptionKey string\) \(\[\]byte, error\)](<#EncryptMessage>)
- [func GenerateToken\(nBytes int\) \(string, error\)](<#GenerateToken>)
- [func PickRandomBinaries\(\) \(\[\]string, error\)](<#PickRandomBinaries>)
- [func SendMessage\(ip string, port int, status string, message string, token string, encryptionKey string\)](<#SendMessage>)
- [func SendRawMessage\(ip string, port int, message string, encryptionKey string\) error](<#SendRawMessage>)


<a name="CorruptFile"></a>
## func [CorruptFile](<https://github.com/opensourceCertifications/linux/blob/main/go/library/corrupt_file.go#L28>)

```go
func CorruptFile(path string, percent int) (retErr error)
```

CorruptFile overwrites \~percent% of a file's bytes in\-place using cryptographically random data. Contract:

- percent \< 0 \-\> error
- percent == 0 \-\> no\-op
- 0 \< percent \< 100 \-\> overwrite exactly k = max\(1, floor\(size\*percent/100\)\) unique byte positions
- percent \>= 100 \-\> full overwrite \(exactly size bytes\), without changing file size

Implementation notes:

- No full\-file loads; O\(k\) memory where k is the number of bytes to corrupt.
- Uses CSPRNG for both index selection and bytes.
- Coalesces adjacent positions to reduce syscalls.
- Restores mtime \(atime best\-effort via mtime for portability\).

<a name="CyclicJumble"></a>
## func [CyclicJumble](<https://github.com/opensourceCertifications/linux/blob/main/go/library/file_jumble.go#L25>)

```go
func CyclicJumble(paths []string) error
```

CyclicJumble takes absolute file paths, filters to real regular files via validatePaths, shuffles them using crypto/rand, then performs a cycle so that paths\[i\]’s content becomes paths\[\(i\+1\)%n\], while preserving each destination’s original metadata.

<a name="EncryptMessage"></a>
## func [EncryptMessage](<https://github.com/opensourceCertifications/linux/blob/main/go/library/messages.go#L22>)

```go
func EncryptMessage(message string, encryptionKey string) ([]byte, error)
```

EncryptMessage encrypts the message using the receiver's NaCl box PUBLIC key \(base64\). NOTE: encryptionKey is now expected to be base64\(pubKey\[32\]\). The receiver must decrypt with box.OpenAnonymous using its keypair.

<a name="GenerateToken"></a>
## func [GenerateToken](<https://github.com/opensourceCertifications/linux/blob/main/go/library/messages.go#L89>)

```go
func GenerateToken(nBytes int) (string, error)
```

GenerateToken creates a random hexadecimal token of specified byte length

<a name="PickRandomBinaries"></a>
## func [PickRandomBinaries](<https://github.com/opensourceCertifications/linux/blob/main/go/library/file_selector.go#L165>)

```go
func PickRandomBinaries() ([]string, error)
```

PickRandomBinaries selects between 15 and 20 unique binary file paths

<a name="SendMessage"></a>
## func [SendMessage](<https://github.com/opensourceCertifications/linux/blob/main/go/library/messages.go#L99>)

```go
func SendMessage(ip string, port int, status string, message string, token string, encryptionKey string)
```

SendMessage prepares and sends a structured message to the monitoring server

<a name="SendRawMessage"></a>
## func [SendRawMessage](<https://github.com/opensourceCertifications/linux/blob/main/go/library/messages.go#L52>)

```go
func SendRawMessage(ip string, port int, message string, encryptionKey string) error
```

SendRawMessage sends an encrypted message to the specified IP and port using a TCP connection

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
