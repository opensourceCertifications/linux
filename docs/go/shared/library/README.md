<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# library

```go
import "chaos-agent/shared/library"
```

Package library provides functions to corrupt files by flipping bits and adding an offset.

Package library provides file manipulation utilities. It includes functions for cyclically jumbling file contents while preserving metadata. It ensures safe file operations by preventing path traversal and symlink attacks. It is designed for use in controlled environments where file integrity is critical.

Package library provides utility functions for file selection. It includes functionality to pick random binaries from common system directories.

## Index

- [func CorruptFile\(path string, percent int\) \(string, error\)](<#CorruptFile>)
- [func CorruptPercent\(data \[\]byte, percent int\) error](<#CorruptPercent>)
- [func CyclicJumble\(paths \[\]string\) error](<#CyclicJumble>)
- [func EncryptMessage\(message string, encryptionKey string\) \(\[\]byte, error\)](<#EncryptMessage>)
- [func PickRandomBinaries\(\) \(\[\]string, error\)](<#PickRandomBinaries>)
- [func SendMessage\(ip string, port int, status string, message string, token string, encryptionKey string\)](<#SendMessage>)
- [func SendRawMessage\(ip string, port int, message string, encryptionKey string\) error](<#SendRawMessage>)


<a name="CorruptFile"></a>
## func [CorruptFile](<https://github.com/opensourceCertifications/linux/blob/main/monitor/go/shared/library/corrupt_file.go#L64>)

```go
func CorruptFile(path string, percent int) (string, error)
```

CorruptFile corrupts a file at the given path by flipping bits and adding an offset to a percentage of its bytes. It returns the path of the corrupted file or an error if something goes wrong.

<a name="CorruptPercent"></a>
## func [CorruptPercent](<https://github.com/opensourceCertifications/linux/blob/main/monitor/go/shared/library/corrupt_file.go#L19>)

```go
func CorruptPercent(data []byte, percent int) error
```

CorruptPercent overwrites approximately percent% of bytes \(at least 1 if percent\>0\).

<a name="CyclicJumble"></a>
## func [CyclicJumble](<https://github.com/opensourceCertifications/linux/blob/main/monitor/go/shared/library/file_jumble.go#L44>)

```go
func CyclicJumble(paths []string) error
```

CyclicJumble takes a list of absolute file paths \(regular files\) and performs a cycle: paths\[i\] content \-\> paths\[\(i\+1\)%n\] for all i.

It preserves each destination file's original metadata as much as possible: \- permissions \(mode\), ownership \(uid/gid\), atime/mtime, and extended attributes \(best\-effort\). \- Operations are atomic per destination via rename\(2\) of a same\-dir temp file. Notes/limits: \- ctime cannot be preserved on Linux. \- Non\-regular files \(dirs/symlinks/devices\) are rejected. \- Paths must be unique. CyclicJumble writes content of paths\[i\] into paths\[\(i\+1\)%n\], preserving the destination's metadata captured prior to the swap.

<a name="EncryptMessage"></a>
## func [EncryptMessage](<https://github.com/opensourceCertifications/linux/blob/main/monitor/go/shared/library/messages.go#L17>)

```go
func EncryptMessage(message string, encryptionKey string) ([]byte, error)
```

EncryptMessage encrypts the message using AES\-GCM with the provided encryption key

<a name="PickRandomBinaries"></a>
## func [PickRandomBinaries](<https://github.com/opensourceCertifications/linux/blob/main/monitor/go/shared/library/file_selector.go#L52>)

```go
func PickRandomBinaries() ([]string, error)
```

PickRandomBinaries selects between 15 and 20 unique binary file paths

<a name="SendMessage"></a>
## func [SendMessage](<https://github.com/opensourceCertifications/linux/blob/main/monitor/go/shared/library/messages.go#L111>)

```go
func SendMessage(ip string, port int, status string, message string, token string, encryptionKey string)
```

SendMessage prepares and sends a structured message to the monitoring server

<a name="SendRawMessage"></a>
## func [SendRawMessage](<https://github.com/opensourceCertifications/linux/blob/main/monitor/go/shared/library/messages.go#L70>)

```go
func SendRawMessage(ip string, port int, message string, encryptionKey string) error
```

SendRawMessage sends an encrypted message to the specified IP and port using a TCP connection

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
